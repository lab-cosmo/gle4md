<script type="text/javascript">
out_aunits = typeof pageQuery.aunits !== "undefined" ? pageQuery.aunits : "ps";
out_cunits = typeof pageQuery.cunits !== "undefined" ? pageQuery.cunits : "k";
</script>

<script type="text/javascript">
   document.write("Units of time:&nbsp;"); 
   mkUnit(out_aunits,"aunits","time");
   if (CMAT!="") { document.write("<br/>Units of energy:&nbsp;"); mkUnit(out_cunits,"cunits","nrg"); }
</script>
<br/><br/>
NB: The drift matrix <b>A</b> is output in units of the inverse of the time units given.
The diffusion matrix <b>C</b> is output the energy units given.
Paste the relevant lines into the Python code.

<script type="text/javascript">
OUTS=OUTS+"# These arrays can be pasted into Python code, and in particular converted into numpy arrays if needed\n";
OUTS=OUTS+"\"\"\""+DESC+"\"\"\"\n";

if (multi_mat>0)
{
   OUTS=OUTS+"# A MATRIX: ("+unitname(out_aunits)+"^-1)\n";
   aconv=1.0/conv_i2u(1.0,out_aunits,"time");

   OUTS=OUTS+"A = [\n";
   for (b=0; b<AMAT.length; ++b)
   {
      OUTS=OUTS+"[\n";   
      for (i=0; i<AMAT[b].length; ++i)
      {
        OUTS=OUTS+"[";
        for (j=0; j<AMAT[b][i].length; ++j) 
        { 
          OUTS=OUTS+fmtReal(AMAT[b][i][j]*aconv)+", ";
        }
        OUTS=OUTS+"],\n";
      } 
      OUTS=OUTS+"],\n";
   }
   OUTS=OUTS+"\n]\n";

   if (CMAT != "" ) 
   {
      OUTS=OUTS+"# C MATRIX: ("+unitname(out_cunits)+")\n";
      cconv=conv_i2u(1.0,out_cunits,"nrg");
      OUTS=OUTS+"C = [\n";
      for (b=0; b<CMAT.length; ++b)
      {
        OUTS=OUTS+"[\n";   
        for (i=0; i<CMAT[b].length; ++i)
        {
          OUTS=OUTS+"[";
          for (j=0; j<CMAT[b][i].length; ++j) 
          { 
            OUTS=OUTS+fmtReal(CMAT[b][i][j]*cconv)+", ";
          }
          OUTS=OUTS+"],\n";
        } 
        OUTS=OUTS+"],\n";
      }
      OUTS=OUTS+"\n]\n";
   }
}
else
{
   OUTS=OUTS+"# A MATRIX: ("+unitname(out_aunits)+"^-1)\n";
   aconv=1.0/conv_i2u(1.0,out_aunits,"time");

   OUTS=OUTS+"A = [\n";
   for (i=0; i<AMAT.length; ++i)
   {
     OUTS=OUTS+"[";
     for (j=0; j<AMAT[i].length; ++j) 
     { 
       OUTS=OUTS+fmtReal(AMAT[i][j]*aconv)+", ";
     }
     OUTS=OUTS+"],\n";
   } 
   OUTS=OUTS+"]\n";

   if (CMAT != "" ) 
   {
      OUTS=OUTS+"# C MATRIX: ("+unitname(out_cunits)+")\n";
      cconv=conv_i2u(1.0,out_cunits,"nrg");
      OUTS=OUTS+"C = [\n";
      for (i=0; i<CMAT.length; ++i)
      {
        OUTS=OUTS+"[";
        for (j=0; j<CMAT[i].length; ++j) 
        { 
          OUTS=OUTS+fmtReal(CMAT[i][j]*cconv)+", ";
        }
        OUTS=OUTS+"],\n";
      } 
      OUTS=OUTS+"]\n";
   }
}
</script>
