<script type="text/javascript">

libroot=libroot+"smart/smart-0.5_";

//Parses GLE-specific parameters
//$gle_wmax=$_POST['wmax'];       if ($gle_wmax=="")  $gle_wmax=4000;
gle_tslow   = typeof pageQuery.tslow   !== "undefined" ? pageQuery.tslow     : 20;
gle_utslow  = typeof pageQuery.utslow  !== "undefined" ? pageQuery.utslow   : "ps";
gle_smrange= typeof pageQuery.smrange !== "undefined" ? pageQuery.smrange  : "6-4";

//list($gle_ns,$gle_ww)=explode("-", $gle_smrange);
xset=gle_smrange.split("-"); 
gle_ns=xset[0]; gle_ww=xset[1];

gle_wmax=Math.pow(10.0,gle_ww)/conv_u2i(gle_tslow,gle_utslow,"time");

DESC="# Generated at http://epfl-cosmo.github.io/gle4md\n\
# Please cite:\n\
# M. Ceriotti, G. Bussi and M. Parrinello, J. Chem. Theory Comput. 6, 1170 (2010) \n\
# M. Ceriotti, G. Bussi and M. Parrinello, Phys. Rev. Lett. 102, 020601 (2009)\n\
# Smart-sampling GLE. Enforces efficient sampling, focussing the effort on the slowest mode \n\
# accessible by the simulation. Generated from the parameter file\n\
# "+libroot+gle_smrange+".a, \n\
# and shifted so that they are effective to sample optimally \n\
# a time scale of t_opt="+(gle_tslow)+"&nbsp;"+unitname(gle_utslow)+",\n\
# and do as well as possible upt to a cutoff frequency of \n\
# &nu;max="+(Math.round(gle_wmax,2))+"&nbsp;THz ["+(Math.round(conv_i2u(gle_wmax,'cm1','freq'),2))+"&nbsp;cm^-1]\n\
";

HELP="\
     Smart-sampling GLE: similar to optimal sampling, but tries to improve the sampling\n\
     efficiency for slower collective motion -- with the idea that fast modes will be \n\
     sampled many times anyway. One needs to specify a rough estimate of the slowest \n\
     time scale that is interesting to be sampled (typically should be comparable to the \n\
     a fraction of the total simulation affordable). The chosen parameters will yield a good compromise \n\
     between sampling as efficiently as possible this slowest motion and the faster one, up \n\
     to a maximum requency cutoff that depends on the choice of &omega;max/&omega;min. \n\
     Enforces fluctuation-dissipation theorem, so canonical sampling will result.\n\
";
</script>

<script type="text/javascript">
mkField(gle_tslow,"tslow","t_opt",gle_utslow,"time");
</script>

<div class='label'>Ns/Range</div>&nbsp;<select name="smrange" onchange='this.form.submit()'>
<script type="text/javascript">
mkOption(gle_smrange,"6-2","Ns=6, &omega;max/&omega;min=10^2");
mkOption(gle_smrange,"6-3","Ns=6, &omega;max/&omega;min=10^3");
mkOption(gle_smrange,"6-4","Ns=6, &omega;max/&omega;min=10^4");
mkOption(gle_smrange,"6-5","Ns=6, &omega;max/&omega;min=10^5");
mkOption(gle_smrange,"6-6","Ns=6, &omega;max/&omega;min=10^6");
mkOption(gle_smrange,"8-2","Ns=8, &omega;max/&omega;min=10^2");
</script>
</select><br/>
<b>Maximum frequency optimized:</b><br/>
<script type="text/javascript">
 document.write((Math.round(conv_i2u(gle_wmax,'cm1','freq'),2))+"&nbsp;cm^-1");
</script>

<script type="text/javascript">
gle_iwmax=2*Math.PI*gle_wmax;    //we read a frequency but need an ANGULAR frequency

AMAT=readMatrix(libroot+gle_smrange+".a", gle_iwmax); 
CMAT="";
</script>
